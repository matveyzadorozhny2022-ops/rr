<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tap Game Optimized</title>
<style>
*{box-sizing:border-box;touch-action:manipulation;}
body{
margin:0;padding:0;display:flex;flex-direction:column;justify-content:center;align-items:center;
font-family:"Comic Sans MS";color:#fff;height:100dvh;overflow:hidden;
background:#000 url('fon.jpg') center/cover no-repeat;
}
#topWrap{display:flex;flex-direction:column;align-items:center;gap:6px;margin-bottom:4px;}
#message{
min-height:48px;display:flex;align-items:center;justify-content:center;
font-size:1.15rem;text-align:center;transition:opacity .25s;
}
#slot{width:100%;display:flex;justify-content:center;align-items:center;height:220px;position:relative;}
#btn,#gift{width:55vw;max-width:260px;position:absolute;user-select:none;pointer-events:auto;will-change:transform,opacity;}
#gift{opacity:0;transform:scale(.75);pointer-events:none;transition:.28s ease;}
#btn{cursor:pointer;transition:transform .18s ease;}
#btn:active{transform:scale(.92);} 
@media(max-width:480px){#btn,#gift{width:60vw;}}
.progress-wrap{
width:55vw;max-width:350px;height:8px;background:rgba(255,255,255,.2);
border-radius:20px;overflow:hidden;transition:opacity .25s;
}
.progress{height:100%;width:0;background:#FFB400;transition:width .22s linear;}
#confirmBox{
position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.85);
background:rgba(0,0,0,.92);padding:22px;border-radius:16px;
text-align:center;color:#fff;opacity:0;pointer-events:none;
backdrop-filter:blur(6px);transition:.28s;
}
#confirmBox.show{opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1);}
.confirm-btn{
padding:10px 25px;border:none;border-radius:12px;font-size:1rem;
margin:6px;font-weight:bold;cursor:pointer;transition:.2s;
}
#sellBtn{background:#0092ff;color:#fff;}#receiveBtn{background:#FFD800;color:#222;}
.confirm-btn:active{transform:scale(.92);} 
.firework{position:absolute;pointer-events:none;will-change:transform,opacity;}
@keyframes fall{to{transform:translateY(120vh) scale(.6);opacity:0;}}
@keyframes pulse{to{transform:scale(.94);}}
</style>
</head>
<body>
<div id="topWrap">
<div id="message">üëÜ –ù–∞–∂–∏–º–∞–π, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫!</div>
<div class="progress-wrap"><div id="bar" class="progress"></div></div>
</div>
<div id="slot">
<img id="btn" loading="eager">
<img id="gift" loading="lazy">
</div>
<div id="confirmBox">
<p>–ü—Ä–æ–¥–∞—Ç—å –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫?</p>
<button id="sellBtn" class="confirm-btn">–ü–†–û–î–ê–¢–¨</button>
<button id="receiveBtn" class="confirm-btn">–ü–û–õ–£–ß–ò–¢–¨</button>
</div>
<script>
const msg=document.getElementById("message"),btn=document.getElementById("btn"),gift=document.getElementById("gift"),bar=document.getElementById("bar"),box=document.getElementById("confirmBox"),sell=document.getElementById("sellBtn"),recv=document.getElementById("receiveBtn"),prog=document.querySelector(".progress-wrap");
const btns=['btn1.webp','btn2.webp','btn3.webp'];
const gifts=Array.from({length:15},(_,i)=>`g${i+1}.webp`);
const fw=['f1.webp','f2.webp','f3.webp'];
btn.src=btns[Math.random()*3|0];
const cores=navigator.hardwareConcurrency||2;
const isMobile=matchMedia("(pointer: coarse)").matches;
const LOW=cores<=3;
const FW_COUNT=LOW?8:(isMobile?18:55);
let taps=0,total=5,started=false;
btn.addEventListener("click",tap);
function tap(){
if(!started){started=true;btn.style.animation="pulse .65s infinite alternate";}
taps++;
bar.style.width=(taps/total*100)+"%";
msg.textContent=taps<total?`–ü—Ä–æ–¥–æ–ª–∂–∞–π! –û—Å—Ç–∞–ª–æ—Å—å ${total-taps} —Ç–∞–ø–æ–≤ üéÅ`:`üéâ –ü–æ–¥–∞—Ä–æ–∫ –ø–æ–ª—É—á–µ–Ω!`;
if(taps===total) revealGift();}
function revealGift(){
btn.style.opacity=0;btn.style.pointerEvents="none";setTimeout(()=>btn.style.display="none",200);
prog.style.opacity=0;
setTimeout(()=>prog.style.display="none",250);
const img=new Image();img.src=gifts[Math.random()*15|0];img.onload=()=>{gift.src=img.src;gift.style.opacity=1;gift.style.transform="scale(1)";gift.style.pointerEvents="auto";};}
function launchFX(){let i=0;const n=FW_COUNT;function spawn(){const f=document.createElement("img");f.src=fw[Math.random()*fw.length|0];f.className="firework";f.style.width=(isMobile?60:110)+"px";f.style.left=(isMobile?"50%":Math.random()*100+"vw");if(isMobile)f.style.transform="translateX(-50%)";f.style.top=(Math.random()*-25)+"vh";f.style.animation=`fall ${0.7+Math.random()*1}s linear forwards`;document.body.appendChild(f);setTimeout(()=>f.remove(),1500);}function loop(){if(i>=n)return;spawn();i++;requestAnimationFrame(loop);}loop();}
gift.onclick=()=>box.classList.add("show");
sell.onclick=()=>finish("üí∞ –ü—Ä–æ–¥–∞–Ω–æ! ‚≠ê –°–∫–æ—Ä–æ –ø–æ—Å—Ç—É–ø—è—Ç –Ω–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å Telegram");
recv.onclick=()=>finish("üéÅ –ü–æ–¥–∞—Ä–æ–∫ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å –≤ —Ç–µ—á–µ–Ω–∏–∏ –º–∏–Ω—É—Ç—ã");
function finish(t){box.classList.remove("show");msg.textContent=t;gift.style.opacity=0;gift.style.transform="scale(.75)";setTimeout(()=>gift.style.pointerEvents="none",280);}
</script>
</body>
</html>
